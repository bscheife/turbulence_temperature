function [costs]=C11(dofc11,S_obs,S_theoretical)%%USE: [costs]=C11(dofc11,S_obs,S_theoretical)%%This function calculates the cost function value of a theoretical fit to a %real spectrum. Called from Fit_Kb.m to calculate cost function values%with given information. It assumes the statistical variability is%distributed as a chi^2 distribution. See Ruddick et al 2000. %% INPUTS: dofc11-> This value, usually =2, is a Chi-squared parameter when%						modelling the errors.%	k_obs  -> This is a vector of k values from the observed spectrum data.%		The vector is x by 1 in size, where x is the number of k values%	S_obs  -> This is a vector of observed spectral values from the spectral%		data. The vector is x by 1 in size, x as before.%	S_theoretical -> This is a vector of the fitted curve spectral values. %	The vector is x by 1 long, with x as before.%%OUTPUTS: costs -> the cost function value for the given observed spectrum%				and theoretical fitted spectrum. C11 = log((chi2pdf(dofc11.*S_obs./(S_theoretical+eps),dofc11) ...        .* dofc11 ./ (S_theoretical+eps)) + eps);%the eps factor is a small matlab number (2.2204e-16) added to prevent the%log operation from producing errors by attempting to take the log of a%very small numbercosts = sum(sum(C11));end